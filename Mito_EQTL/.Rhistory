cat('Analysis done in: ', me_stan_cv$time.in.sec, ' seconds', '\n');
cat('Detected eQTLs:', '\n');
show(me_stan$all$eqtls)
#log normlized data
plot(me_log_cv)
plot(me_log_cv_qq)
#standard normalized data
plot(me_stan_cv)
plot(me_stan_cv_qq)
library(MatrixEQTL)
#import library
#set work directory
setwd("C:/Users/khuub/One Drive/OneDrive/Desktop/Projects/projects/Mito_EQTL");
#setwd("/home/brandon/workspace/projects/Mito_EQTL")
#files in use
allele = read.csv ="allele.csv";
count_epression_log_norm = "count_expression_log2.csv";
count_epression_standard_norm = "count_expression_INT.csv";
co_var = "mito_covariates.csv";
#settings for engine
useModel = modelLINEAR
covariates_applied = numeric();
output_file_name = tempfile();
pvOutputThreshold = 1e-2;
errorCovariance = numeric();
cisDist = 1e6;
#Load data
#Genotype
snps = SlicedData$new();
snps$fileDelimiter = ",";
snps$fileOmitCharacters = "NA";
snps$fileSkipRows = 1;
snps$fileSkipColumns = 1;
snps$fileSliceSize = 2000;
snps$LoadFile(allele);
#Expression - Log Standardized
gene_log = SlicedData$new();
gene_log$fileDelimiter = ",";
gene_log$fileOmitCharacters = "NA";
gene_log$fileSkipRows = 1;
gene_log$fileSkipColumns = 1;
gene_log$fileSliceSize = 2000;
gene_log$LoadFile("count_expression_log2.csv");
#Expression - SK Learn StandardScaler
gene_stan = SlicedData$new();
gene_stan$fileDelimiter = ",";
gene_stan$fileOmitCharacters = "NA";
gene_stan$fileSkipRows = 1;
gene_stan$fileSkipColumns = 1;
gene_stan$fileSliceSize = 2000;
gene_stan$LoadFile("Count_Expression_INT.csv");
#covariates
cvrt_applied = SlicedData$new();
cvrt_applied$fileDelimiter = ",";
cvrt_applied$fileOmitCharacters = "NA";
cvrt_applied$fileSkipRows = 1;
cvrt_applied$fileSkipColumns = 1;
if(length(covariates_applied)>0) {
cvrt_applied$LoadFile(covariates_applied);}
#Analysis
#log normalized and covariates data
me_log_cv = Matrix_eQTL_engine(
snps = snps,
gene = gene_log,
cvrt = cvrt_applied,
output_file_name = output_file_name,
pvOutputThreshold = pvOutputThreshold,
useModel = useModel,
errorCovariance = errorCovariance,
verbose = TRUE,
pvalue.hist = TRUE,
min.pv.by.genesnp = TRUE,
noFDRsaveMemory = FALSE
);
unlink(output_file_name)
#log normalized and covariates data
me_log_cv_qq = Matrix_eQTL_engine(
snps = snps,
gene = gene_log,
cvrt = cvrt_applied,
output_file_name = output_file_name,
pvOutputThreshold = pvOutputThreshold,
useModel = useModel,
errorCovariance = errorCovariance,
verbose = TRUE,
pvalue.hist = "qqplot",
min.pv.by.genesnp = TRUE,
noFDRsaveMemory = FALSE
);
unlink(output_file_name)
#standardized and covariates data
me_stan_cv = Matrix_eQTL_engine(
snps = snps,
gene = gene_stan,
cvrt = cvrt_applied,
output_file_name = output_file_name,
pvOutputThreshold = pvOutputThreshold,
useModel = useModel,
errorCovariance = errorCovariance,
verbose = TRUE,
pvalue.hist = TRUE,
min.pv.by.genesnp = TRUE,
noFDRsaveMemory = FALSE
);
unlink(output_file_name)
#standardized and covariates data
me_stan_cv_qq = Matrix_eQTL_engine(
snps = snps,
gene = gene_stan,
cvrt = cvrt_applied,
output_file_name = output_file_name,
pvOutputThreshold = pvOutputThreshold,
useModel = useModel,
errorCovariance = errorCovariance,
verbose = TRUE,
pvalue.hist = "qqplot",
min.pv.by.genesnp = TRUE,
noFDRsaveMemory = FALSE
);
unlink(output_file_name)
#analysis
#log normalized data
cat('Analysis done in: ', me_log_cv$time.in.sec, ' seconds', '\n');
cat('Detected eQTLs:', '\n');
show(me_log$all$eqtls)
#standard noramlized data
cat('Analysis done in: ', me_stan_cv$time.in.sec, ' seconds', '\n');
cat('Detected eQTLs:', '\n');
show(me_stan_cv$all$eqtls)
library(MatrixEQTL)
#import library
#set work directory
setwd("C:/Users/khuub/One Drive/OneDrive/Desktop/Projects/projects/Mito_EQTL");
#setwd("/home/brandon/workspace/projects/Mito_EQTL")
#files in use
allele = read.csv ="allele.csv";
count_epression_log_norm = "count_expression_log2.csv";
count_epression_standard_norm = "count_expression_INT.csv";
co_var = "mito_covariates.csv";
#settings for engine
useModel = modelLINEAR
covariates_applied = numeric();
output_file_name = tempfile();
pvOutputThreshold = 1e-2;
errorCovariance = numeric();
cisDist = 1e6;
#Load data
#Genotype
snps = SlicedData$new();
snps$fileDelimiter = ",";
snps$fileOmitCharacters = "NA";
snps$fileSkipRows = 1;
snps$fileSkipColumns = 1;
snps$fileSliceSize = 2000;
snps$LoadFile(allele);
#Expression - Log Standardized
gene_log = SlicedData$new();
gene_log$fileDelimiter = ",";
gene_log$fileOmitCharacters = "NA";
gene_log$fileSkipRows = 1;
gene_log$fileSkipColumns = 1;
gene_log$fileSliceSize = 2000;
gene_log$LoadFile("count_expression_log2.csv");
#Expression - SK Learn StandardScaler
gene_stan = SlicedData$new();
gene_stan$fileDelimiter = ",";
gene_stan$fileOmitCharacters = "NA";
gene_stan$fileSkipRows = 1;
gene_stan$fileSkipColumns = 1;
gene_stan$fileSliceSize = 2000;
gene_stan$LoadFile("Count_Expression_INT.csv");
#covariates
cvrt_applied = SlicedData$new();
cvrt_applied$fileDelimiter = ",";
cvrt_applied$fileOmitCharacters = "NA";
cvrt_applied$fileSkipRows = 1;
cvrt_applied$fileSkipColumns = 1;
if(length(covariates_applied)>0) {
cvrt_applied$LoadFile(covariates_applied);}
#Analysis
#log normalized and covariates data
me_log_cv = Matrix_eQTL_engine(
snps = snps,
gene = gene_log,
cvrt = cvrt_applied,
output_file_name = output_file_name,
pvOutputThreshold = pvOutputThreshold,
useModel = useModel,
errorCovariance = errorCovariance,
verbose = TRUE,
pvalue.hist = TRUE,
min.pv.by.genesnp = TRUE,
noFDRsaveMemory = FALSE
);
unlink(output_file_name)
#log normalized and covariates data
me_log_cv_qq = Matrix_eQTL_engine(
snps = snps,
gene = gene_log,
cvrt = cvrt_applied,
output_file_name = output_file_name,
pvOutputThreshold = pvOutputThreshold,
useModel = useModel,
errorCovariance = errorCovariance,
verbose = TRUE,
pvalue.hist = "qqplot",
min.pv.by.genesnp = TRUE,
noFDRsaveMemory = FALSE
);
unlink(output_file_name)
#standardized and covariates data
me_stan_cv = Matrix_eQTL_engine(
snps = snps,
gene = gene_stan,
cvrt = cvrt_applied,
output_file_name = output_file_name,
pvOutputThreshold = pvOutputThreshold,
useModel = useModel,
errorCovariance = errorCovariance,
verbose = TRUE,
pvalue.hist = TRUE,
min.pv.by.genesnp = TRUE,
noFDRsaveMemory = FALSE
);
unlink(output_file_name)
#standardized and covariates data
me_stan_cv_qq = Matrix_eQTL_engine(
snps = snps,
gene = gene_stan,
cvrt = cvrt_applied,
output_file_name = output_file_name,
pvOutputThreshold = pvOutputThreshold,
useModel = useModel,
errorCovariance = errorCovariance,
verbose = TRUE,
pvalue.hist = "qqplot",
min.pv.by.genesnp = TRUE,
noFDRsaveMemory = FALSE
);
unlink(output_file_name)
#analysis
#log normalized data
#cat('Analysis done in: ', me_log_cv$time.in.sec, ' seconds', '\n');
#cat('Detected eQTLs:', '\n');
#show(me_log$all$eqtls)
#standard noramlized data
cat('Analysis done in: ', me_stan_cv$time.in.sec, ' seconds', '\n');
cat('Detected eQTLs:', '\n');
show(me_stan_cv$all$min.pv.gene)
library(MatrixEQTL)
#import library
#set work directory
setwd("C:/Users/khuub/One Drive/OneDrive/Desktop/Projects/projects/Mito_EQTL");
#setwd("/home/brandon/workspace/projects/Mito_EQTL")
#files in use
allele = read.csv ="allele.csv";
count_epression_log_norm = "count_expression_log2.csv";
count_epression_standard_norm = "count_expression_INT.csv";
co_var = "mito_covariates.csv";
#settings for engine
useModel = modelLINEAR
covariates_applied = numeric();
output_file_name = tempfile();
pvOutputThreshold = 1e-2;
errorCovariance = numeric();
cisDist = 1e6;
#Load data
#Genotype
snps = SlicedData$new();
snps$fileDelimiter = ",";
snps$fileOmitCharacters = "NA";
snps$fileSkipRows = 1;
snps$fileSkipColumns = 1;
snps$fileSliceSize = 2000;
snps$LoadFile(allele);
#Expression - Log Standardized
gene_log = SlicedData$new();
gene_log$fileDelimiter = ",";
gene_log$fileOmitCharacters = "NA";
gene_log$fileSkipRows = 1;
gene_log$fileSkipColumns = 1;
gene_log$fileSliceSize = 2000;
gene_log$LoadFile("count_expression_log2.csv");
#Expression - SK Learn StandardScaler
gene_stan = SlicedData$new();
gene_stan$fileDelimiter = ",";
gene_stan$fileOmitCharacters = "NA";
gene_stan$fileSkipRows = 1;
gene_stan$fileSkipColumns = 1;
gene_stan$fileSliceSize = 2000;
gene_stan$LoadFile("Count_Expression_INT.csv");
#covariates
cvrt_applied = SlicedData$new();
cvrt_applied$fileDelimiter = ",";
cvrt_applied$fileOmitCharacters = "NA";
cvrt_applied$fileSkipRows = 1;
cvrt_applied$fileSkipColumns = 1;
if(length(covariates_applied)>0) {
cvrt_applied$LoadFile(covariates_applied);}
#Analysis
#log normalized and covariates data
me_log_cv = Matrix_eQTL_engine(
snps = snps,
gene = gene_log,
cvrt = cvrt_applied,
output_file_name = output_file_name,
pvOutputThreshold = pvOutputThreshold,
useModel = useModel,
errorCovariance = errorCovariance,
verbose = TRUE,
pvalue.hist = TRUE,
min.pv.by.genesnp = TRUE,
noFDRsaveMemory = FALSE
);
unlink(output_file_name)
#log normalized and covariates data
me_log_cv_qq = Matrix_eQTL_engine(
snps = snps,
gene = gene_log,
cvrt = cvrt_applied,
output_file_name = output_file_name,
pvOutputThreshold = pvOutputThreshold,
useModel = useModel,
errorCovariance = errorCovariance,
verbose = TRUE,
pvalue.hist = "qqplot",
min.pv.by.genesnp = TRUE,
noFDRsaveMemory = FALSE
);
unlink(output_file_name)
#standardized and covariates data
me_stan_cv = Matrix_eQTL_engine(
snps = snps,
gene = gene_stan,
cvrt = cvrt_applied,
output_file_name = output_file_name,
pvOutputThreshold = pvOutputThreshold,
useModel = useModel,
errorCovariance = errorCovariance,
verbose = TRUE,
pvalue.hist = TRUE,
min.pv.by.genesnp = TRUE,
noFDRsaveMemory = FALSE
);
unlink(output_file_name)
#standardized and covariates data
me_stan_cv_qq = Matrix_eQTL_engine(
snps = snps,
gene = gene_stan,
cvrt = cvrt_applied,
output_file_name = output_file_name,
pvOutputThreshold = pvOutputThreshold,
useModel = useModel,
errorCovariance = errorCovariance,
verbose = TRUE,
pvalue.hist = "qqplot",
min.pv.by.genesnp = TRUE,
noFDRsaveMemory = FALSE
);
unlink(output_file_name)
#analysis
#log normalized data
#cat('Analysis done in: ', me_log_cv$time.in.sec, ' seconds', '\n');
#cat('Detected eQTLs:', '\n');
#show(me_log$all$eqtls)
#standard noramlized data
cat('Analysis done in: ', me_stan_cv$time.in.sec, ' seconds', '\n');
cat('Detected eQTLs:', '\n');
#show(me_stan_cv$all$min.pv.gene)
x = me_stan_cv$all$min.pv.gene
install.packages('ggplot2')
library(ggplot2)
qplot(x, geom = "histogram")
qplot(x, geom = "histogram", binwidth =0.5 )
hist(x)
qplot(x, geom = "histogram", binwidth =0.25 )
qplot(x, geom = "histogram", binwidth =0.01 )
qplot(x, geom = "histogram", binwidth =0.001 )
qplot(x, geom = "histogram", binwidth =0.05 )
qplot(x) + geom_histogram(breaks=seq(20,50, by=2), col="white", fill="grey")
qplot(x) + geom_histogram(breaks=seq(20,1, by=2), col="white", fill="grey")
qplot(x) + geom_histogram(breaks=seq(20,1, by=0.001), col="white", fill="grey")
qplot(x) + geom_histogram(breaks=seq(0,1, by=0.001), col="white", fill="grey")
qplot(x, geom = "histogram", binwidth =0.01 )
qplot(x) + geom_histogram(breaks=seq(0,1, by=0.001),bins=100 ,col="white", fill="grey")
qplot(x) + geom_histogram(breaks=seq(0,1, by=0.001),bins=10, fill="grey")
library(MatrixEQTL)
#import library
#set work directory
setwd("C:/Users/khuub/One Drive/OneDrive/Desktop/Projects/projects/Mito_EQTL");
#setwd("/home/brandon/workspace/projects/Mito_EQTL")
#files in use
allele = read.csv ="allele.csv";
count_epression_log_norm = "count_expression_log2.csv";
count_epression_standard_norm = "count_expression_INT.csv";
co_var = "mito_covariates.csv";
#settings for engine
useModel = modelLINEAR
covariates_applied = numeric();
output_file_name = tempfile();
pvOutputThreshold = 1e-2;
errorCovariance = numeric();
cisDist = 1e6;
#Load data
#Genotype
snps = SlicedData$new();
snps$fileDelimiter = ",";
snps$fileOmitCharacters = "NA";
snps$fileSkipRows = 1;
snps$fileSkipColumns = 1;
snps$fileSliceSize = 2000;
snps$LoadFile(allele);
#Expression - Log Standardized
gene_log = SlicedData$new();
gene_log$fileDelimiter = ",";
gene_log$fileOmitCharacters = "NA";
gene_log$fileSkipRows = 1;
gene_log$fileSkipColumns = 1;
gene_log$fileSliceSize = 2000;
gene_log$LoadFile("fpkm_expression_log2.csv");
#Expression - SK Learn StandardScaler
gene_stan = SlicedData$new();
gene_stan$fileDelimiter = ",";
gene_stan$fileOmitCharacters = "NA";
gene_stan$fileSkipRows = 1;
gene_stan$fileSkipColumns = 1;
gene_stan$fileSliceSize = 2000;
gene_stan$LoadFile("fpkm_expression_INT.csv");
#covariates
cvrt_applied = SlicedData$new();
cvrt_applied$fileDelimiter = ",";
cvrt_applied$fileOmitCharacters = "NA";
cvrt_applied$fileSkipRows = 1;
cvrt_applied$fileSkipColumns = 1;
if(length(covariates_applied)>0) {
cvrt_applied$LoadFile(covariates_applied);}
#Analysis
#log normalized and covariates data
me_log_cv = Matrix_eQTL_engine(
snps = snps,
gene = gene_log,
cvrt = cvrt_applied,
output_file_name = output_file_name,
pvOutputThreshold = pvOutputThreshold,
useModel = useModel,
errorCovariance = errorCovariance,
verbose = TRUE,
pvalue.hist = TRUE,
min.pv.by.genesnp = TRUE,
noFDRsaveMemory = FALSE
);
unlink(output_file_name)
#log normalized and covariates data
me_log_cv_qq = Matrix_eQTL_engine(
snps = snps,
gene = gene_log,
cvrt = cvrt_applied,
output_file_name = output_file_name,
pvOutputThreshold = pvOutputThreshold,
useModel = useModel,
errorCovariance = errorCovariance,
verbose = TRUE,
pvalue.hist = "qqplot",
min.pv.by.genesnp = TRUE,
noFDRsaveMemory = FALSE
);
unlink(output_file_name)
#standardized and covariates data
me_stan_cv = Matrix_eQTL_engine(
snps = snps,
gene = gene_stan,
cvrt = cvrt_applied,
output_file_name = output_file_name,
pvOutputThreshold = pvOutputThreshold,
useModel = useModel,
errorCovariance = errorCovariance,
verbose = TRUE,
pvalue.hist = TRUE,
min.pv.by.genesnp = TRUE,
noFDRsaveMemory = FALSE
);
unlink(output_file_name)
#standardized and covariates data
me_stan_cv_qq = Matrix_eQTL_engine(
snps = snps,
gene = gene_stan,
cvrt = cvrt_applied,
output_file_name = output_file_name,
pvOutputThreshold = pvOutputThreshold,
useModel = useModel,
errorCovariance = errorCovariance,
verbose = TRUE,
pvalue.hist = "qqplot",
min.pv.by.genesnp = TRUE,
noFDRsaveMemory = FALSE
);
unlink(output_file_name)
#analysis
#log normalized data
cat('Analysis done in: ', me_log_cv$time.in.sec, ' seconds', '\n');
cat('Detected eQTLs:', '\n');
show(me_log_cv$all$eqtls)
#standard noramlized data
cat('Analysis done in: ', me_stan_cv$time.in.sec, ' seconds', '\n');
cat('Detected eQTLs:', '\n');
show(me_stan_cv$all$min.pv.gene)
#log normlized data
plot(me_log_cv)
plot(me_log_cv_qq)
#standard normalized data
plot(me_stan_cv)
plot(me_stan_cv_qq)
