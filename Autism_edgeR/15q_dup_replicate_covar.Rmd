---
title: "15q_dup"
author: "Brandon"
date: "4/9/2021"
output: html_document
---


#load working directory and library
```{r setup, include=FALSE}
#setwd("C:/Users/khuub/One Drive/OneDrive/Desktop/Projects/projects/Autism_edgeR/")
library(edgeR)
```

#Import data
```{r}
counts <- read.csv("15q_dup_fpkm_avg_threshold_no_index.csv",header=TRUE)
m <- as.matrix(counts)

group <- as.factor(rep(c("Control","Case"),c(12,4)))

co <- read.csv('15qdup_pc1.csv',header=FALSE)
```

#Create DGE List Obj
```{r}
d <- DGEList(counts = m, group=group)
```

#Clean Data
```{r}
#keep <- filterByExpr(d,group=group)
#d <- d[keep,,keep.lib.sizes=FALSE]
```

#Normalize Data
```{r}
d <- calcNormFactors(d, method="RLE")
```

#Create design Matrix, apply covariates
```{r}
design <- model.matrix(~0+group,co)
```



#Test
```{r}
d <- estimateDisp(d,design)
de.com <- exactTest(d,pair = c("Case","Control"))

#Results
topTags(de.com)
hist(de.com$table$PValue,prob=TRUE)
write.csv(de.com$table,"test_no_filter_15q_table.csv")
```
